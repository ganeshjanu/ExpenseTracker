node {
    stage('GIT Checkout'){
        git branch: 'ganesh', credentialsId: 'git-cred', url: 'https://github.com/ganeshjanu/ExpenseTracker'
    
        mail bcc: '', body: '''Hi - Email alert for Jenkins Expense Tracker job.
        **** GIT Checkout success! ***
        Thanks,
        GSSK''', cc: '', from: '', replyTo: '', subject: 'Jenkins Expense tracker job - GIT Checkout ', to: 'ganeshjanu@gmail.com , Shailesh.Budhaner@westernunion.com , Ganesh.Sundaresan@westernunion.com ,Sateesh.Bandi@westernunion.com, Karthikeyan.ravichandran@wu.com'
        
        
        
        
    }
    stage('MVN Build'){
        def mvnHome = tool name: 'Maven-3.6.3', type: 'maven'
        def mvnCMD = "${mvnHome}/bin/mvn"
        sh "${mvnCMD} -f employee/pom.xml clean package"
        mail bcc: '', body: '''Hi - Email alert for Jenkins Expense Tracker job.
        **** MVN Build success! ***
        Thanks,
        GSSK''', cc: '', from: '', replyTo: '', subject: 'Jenkins Expense tracker job - MVN Build ', to: 'ganeshjanu@gmail.com , Shailesh.Budhaner@westernunion.com , Ganesh.Sundaresan@westernunion.com ,Sateesh.Bandi@westernunion.com, Karthikeyan.ravichandran@wu.com'
        
        
        
        
    }
    stage('Build docker image'){
        sh 'docker build -f employee/Dockerfile -t karthxyz/employee-app:1.0.0 ./employee'
        mail bcc: '', body: '''Hi - Email alert for Jenkins Expense Tracker job.
        **** Build docker image success! ***
        Thanks,
        GSSK''', cc: '', from: '', replyTo: '', subject: 'Jenkins Expense tracker job - Build docker image', to: 'ganeshjanu@gmail.com , Shailesh.Budhaner@westernunion.com , Ganesh.Sundaresan@westernunion.com ,Sateesh.Bandi@westernunion.com, Karthikeyan.ravichandran@wu.com'
        
        
        
    }
    stage('Push docker image'){
        withCredentials([string(credentialsId: 'docker-pwd', variable: 'dockerPwd')]) {
        sh "docker login -u karthxyz -p ${dockerpwd}"
        
        }
        sh 'docker push karthxyz/employee-app:1.0.0'
        mail bcc: '', body: '''Hi - Email alert for Jenkins Expense Tracker job.
        **** push docker image success! ***
        Thanks,
        GSSK''', cc: '', from: '', replyTo: '', subject: 'Jenkins Expense tracker job - push docker image', to: 'ganeshjanu@gmail.com , Shailesh.Budhaner@westernunion.com , Ganesh.Sundaresan@westernunion.com ,Sateesh.Bandi@westernunion.com, Karthikeyan.ravichandran@wu.com'
           
        
    }
      stage('remove docker image'){
        sh 'docker rmi -f karthxyz/employee-app:1.0.0'
    }
    
}
